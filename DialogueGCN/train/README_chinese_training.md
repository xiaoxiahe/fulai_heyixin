# ä¸­æ–‡å¯¹è¯æƒ…ç»ªè¯†åˆ«è®­ç»ƒæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

è¿™ä¸ªé¡¹ç›®åŸºäºDialogueGCNæ¨¡å‹ï¼Œä¸“é—¨é’ˆå¯¹ä¸­æ–‡å¯¹è¯è¿›è¡Œæƒ…ç»ªè¯†åˆ«è®­ç»ƒï¼Œé€‚é…datapreæ–‡ä»¶å¤¹çš„æ•°æ®æ ¼å¼ã€‚

## ğŸ¯ æƒ…ç»ªæ ‡ç­¾æ˜ å°„

ä¸¥æ ¼æŒ‰ç…§ç”¨æˆ·æŒ‡å®šçš„æƒ…ç»ªæ ‡ç­¾æ˜ å°„ï¼š

| åŸå§‹æ ‡ç­¾                                                  | æ˜ å°„åˆ°       | æ•°å€¼ | æè¿° |
| --------------------------------------------------------- | ------------ | ---- | ---- |
| `relaxed`, `happy`, `grateful`, `positive-other`          | **happy**    | 1    | å¼€å¿ƒ |
| `neutral`                                                 | **neutral**  | 0    | ä¸­æ€§ |
| `astonished`                                              | **surprise** | 5    | æƒŠè®¶ |
| `depress`, `fear`, `negative-other`, `sadness`, `worried` | **sad**      | 2    | æ‚²ä¼¤ |
| `anger`, `disgust`                                        | **angry**    | 3    | æ„¤æ€’ |

**æ³¨æ„**: åªæ”¯æŒè¿™5ç§æƒ…ç»ªç±»åˆ«ï¼Œæ²¡æœ‰å…¶ä»–ç±»åˆ«ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡æ•°æ®

ç¡®ä¿æ‚¨å·²ç»æœ‰äº†datapreæ–‡ä»¶å¤¹å¤„ç†åçš„pklæ•°æ®æ–‡ä»¶ã€‚

### 2. å¼€å§‹è®­ç»ƒ

```bash
# ä½¿ç”¨GPUè®­ç»ƒï¼ˆæ¨èï¼‰
python run_chinese_training.py --data_path ../datapre/your_data_features.pkl --gpu

# ä½¿ç”¨CPUè®­ç»ƒ
python run_chinese_training.py --data_path ../datapre/your_data_features.pkl

# è‡ªå®šä¹‰å‚æ•°
python run_chinese_training.py \
    --data_path ../datapre/your_data_features.pkl \
    --epochs 100 \
    --batch_size 64 \
    --lr 0.0001 \
    --gpu
```

### 3. é«˜çº§è®­ç»ƒé€‰é¡¹

å¦‚æœéœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è®­ç»ƒè„šæœ¬ï¼š

```bash
python train_chinese_dialoguegcn.py \
    --data_path ../datapre/your_data_features.pkl \
    --n_epochs 50 \
    --batch_size 32 \
    --lr 0.0001 \
    --hidden_dim 200 \
    --dropout 0.5 \
    --valid_split 0.1 \
    --optimizer adam \
    --l2 0.00001 \
    --class_weight \
    --cuda
```

## ğŸ“Š æ¨¡å‹å‚æ•°è¯´æ˜

### æ•°æ®å‚æ•°
- `--data_path`: pklæ•°æ®æ–‡ä»¶è·¯å¾„
- `--valid_split`: éªŒè¯é›†æ¯”ä¾‹ï¼ˆé»˜è®¤0.1ï¼‰
- `--batch_size`: æ‰¹å¤„ç†å¤§å°ï¼ˆé»˜è®¤32ï¼‰
- `--num_workers`: æ•°æ®åŠ è½½å™¨å·¥ä½œè¿›ç¨‹æ•°ï¼ˆé»˜è®¤0ï¼‰

### æ¨¡å‹å‚æ•°
- `--hidden_dim`: éšè—å±‚ç»´åº¦ï¼ˆé»˜è®¤200ï¼‰
- `--dropout`: dropoutç‡ï¼ˆé»˜è®¤0.5ï¼‰

### è®­ç»ƒå‚æ•°
- `--n_epochs`: è®­ç»ƒè½®æ•°ï¼ˆé»˜è®¤50ï¼‰
- `--optimizer`: ä¼˜åŒ–å™¨ç±»å‹
  - `adam`: Adamä¼˜åŒ–å™¨ï¼ˆæ¨èï¼‰
  - `sgd`: SGDä¼˜åŒ–å™¨
- `--lr`: å­¦ä¹ ç‡ï¼ˆé»˜è®¤0.0001ï¼‰
- `--l2`: L2æ­£åˆ™åŒ–ç³»æ•°ï¼ˆé»˜è®¤0.00001ï¼‰
- `--momentum`: SGDåŠ¨é‡ï¼ˆé»˜è®¤0.0ï¼‰
- `--class_weight`: æ˜¯å¦ä½¿ç”¨ç±»åˆ«æƒé‡

## ğŸ—ï¸ æ¨¡å‹æ¶æ„

### SimpleDialogueGCNæ¨¡å‹ç‰¹ç‚¹

1. **æ–‡æœ¬ç¼–ç å™¨**: åŒå‘LSTMå¤„ç†BERTç‰¹å¾
2. **è¯´è¯è€…ç¼–ç å™¨**: çº¿æ€§å±‚å¤„ç†è¯´è¯è€…ç‰¹å¾
3. **æ³¨æ„åŠ›æœºåˆ¶**: å¤šå¤´è‡ªæ³¨æ„åŠ›èåˆç‰¹å¾
4. **åˆ†ç±»å™¨**: å…¨è¿æ¥å±‚è¿›è¡Œæƒ…ç»ªåˆ†ç±»

### è¾“å…¥ç‰¹å¾

- **æ–‡æœ¬ç‰¹å¾**: 768ç»´BERTç‰¹å¾
- **è§†è§‰ç‰¹å¾**: 100ç»´é›¶å‘é‡ï¼ˆå ä½ç¬¦ï¼‰
- **éŸ³é¢‘ç‰¹å¾**: 100ç»´é›¶å‘é‡ï¼ˆå ä½ç¬¦ï¼‰
- **è¯´è¯è€…ç‰¹å¾**: 2ç»´one-hotç¼–ç ï¼ˆuser=[1,0], robot=[0,1]ï¼‰

## ğŸ“ˆ è®­ç»ƒç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤ºï¼š

- **è®­ç»ƒæŒ‡æ ‡**: æŸå¤±ã€å‡†ç¡®ç‡ã€F1åˆ†æ•°
- **éªŒè¯æŒ‡æ ‡**: æŸå¤±ã€å‡†ç¡®ç‡ã€F1åˆ†æ•°
- **æµ‹è¯•æŒ‡æ ‡**: æŸå¤±ã€å‡†ç¡®ç‡ã€F1åˆ†æ•°
- **æœ€ä½³æ¨¡å‹**: è‡ªåŠ¨ä¿å­˜F1åˆ†æ•°æœ€é«˜çš„æ¨¡å‹

## ğŸ’¾ æ¨¡å‹ä¿å­˜

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹ï¼š

- æ–‡ä»¶åæ ¼å¼: `chinese_dialoguegcn_model_epoch_X.pth`
- ä¿å­˜æ¡ä»¶: æµ‹è¯•F1åˆ†æ•°è¾¾åˆ°æ–°é«˜æ—¶
- ä¿å­˜å†…å®¹: æ¨¡å‹çŠ¶æ€å­—å…¸

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **CUDAå†…å­˜ä¸è¶³**
   ```bash
   # å‡å°æ‰¹å¤„ç†å¤§å°
   python run_chinese_training.py --data_path your_data.pkl --batch_size 16
   ```

2. **æ•°æ®åŠ è½½é”™è¯¯**
   ```bash
   # æ£€æŸ¥æ•°æ®æ–‡ä»¶æ ¼å¼
   python -c "import pickle; data=pickle.load(open('your_data.pkl', 'rb')); print(data.keys())"
   ```

3. **æ¨¡å‹æ”¶æ•›æ…¢**
   ```bash
   # è°ƒæ•´å­¦ä¹ ç‡
   python run_chinese_training.py --data_path your_data.pkl --lr 0.001
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨GPU**: ç¡®ä¿å®‰è£…äº†CUDAå’ŒPyTorch GPUç‰ˆæœ¬
2. **è°ƒæ•´æ‰¹å¤„ç†å¤§å°**: æ ¹æ®GPUå†…å­˜è°ƒæ•´batch_size
3. **è°ƒæ•´éšè—å±‚ç»´åº¦**: æ ¹æ®æ•°æ®å¤æ‚åº¦è°ƒæ•´hidden_dim

## ğŸ“Š è¯„ä¼°ç»“æœ

è®­ç»ƒå®Œæˆåä¼šæ˜¾ç¤ºï¼š

- æœ€ç»ˆåˆ†ç±»æŠ¥å‘Š
- æ··æ·†çŸ©é˜µ
- å„ç±»åˆ«ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°
- æ•´ä½“å‡†ç¡®ç‡å’ŒåŠ æƒF1åˆ†æ•°

## ğŸ‰ ä¸‹ä¸€æ­¥

è®­ç»ƒå®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š

1. ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œæ¨ç†
2. åœ¨çœŸå®å¯¹è¯ä¸­æµ‹è¯•æ•ˆæœ
3. æ ¹æ®å®é™…æ•ˆæœè°ƒæ•´æ¨¡å‹å‚æ•°
4. è€ƒè™‘é›†æˆåˆ°å®é™…åº”ç”¨ä¸­

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è´¨é‡**: ç¡®ä¿æƒ…ç»ªæ ‡ç­¾åˆ†å¸ƒç›¸å¯¹å‡è¡¡
2. **ç›‘æ§è¿‡æ‹Ÿåˆ**: è§‚å¯Ÿè®­ç»ƒå’ŒéªŒè¯æŒ‡æ ‡å·®å¼‚
3. **è°ƒæ•´è¶…å‚æ•°**: æ ¹æ®å®é™…æ•ˆæœè°ƒæ•´å­¦ä¹ ç‡ã€dropoutç­‰
4. **ä¿å­˜æ£€æŸ¥ç‚¹**: å®šæœŸä¿å­˜æ¨¡å‹ä»¥é˜²è®­ç»ƒä¸­æ–­

## ğŸ” æ•°æ®æ ¼å¼è¦æ±‚

ç¡®ä¿æ‚¨çš„pklæ–‡ä»¶åŒ…å«ä»¥ä¸‹é”®ï¼š

```python
{
    'video_text': {...},      # æ–‡æœ¬ç‰¹å¾å­—å…¸
    'video_speaker': {...},   # è¯´è¯è€…ç‰¹å¾å­—å…¸
    'video_label': {...},     # æƒ…ç»ªæ ‡ç­¾å­—å…¸
    'video_audio': {...},     # éŸ³é¢‘ç‰¹å¾å­—å…¸
    'video_visual': {...},    # è§†è§‰ç‰¹å¾å­—å…¸
    'video_sentence': {...},  # å¥å­æ–‡æœ¬å­—å…¸
    'trainVids': [...],       # è®­ç»ƒé›†å¯¹è¯IDåˆ—è¡¨
    'test_vids': [...]        # æµ‹è¯•é›†å¯¹è¯IDåˆ—è¡¨
}
```